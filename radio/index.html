<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Carregando...</title>
  <style>
    noscript,
    .lds {
      width: calc(3 * 1.25rem);
      height: calc(3 * 1.25rem);

      position: fixed;
      top: 50vh;
      left: 50vw;
      margin-left: calc(-1.5 * 1.25rem);
      margin-top: calc(-1.5 * 1.25rem);
    }

    .lds div {
      box-sizing: border-box;
      display: block;
      position: absolute;
      width: 3rem;
      height: 3rem;
      margin: 8px;
      border: 8px solid #ccc;
      border-radius: 50%;
      animation: lds 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
      border-color: #ccc transparent transparent transparent;
    }

    .lds div:nth-child(1) {
      animation-delay: -0.45s;
    }

    .lds div:nth-child(2) {
      animation-delay: -0.3s;
    }

    .lds div:nth-child(3) {
      animation-delay: -0.15s;
    }

    @data.itms[key]frames lds {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    * {
      font-family: "Noto Sans", "Tahoma", "Arial", "Sans-serif" !important;
      line-height: 1.15em;
      margin: 0;
      padding: 0;
      color: #222;
    }

    noscript {
      display: block;
      width: 280px;
      max-width: 280px;
      height: 160px;
      margin-left: calc(-140px - 1rem);
      margin-top: calc(-80px - .5rem);
      background: rgba(255, 255, 255, .9);
      padding: .5rem 1rem;
      border-left: .5rem solid #eee;
    }

    noscript span {
      opacity: .6;
      font-size: .9rem;
    }

    noscript p {
      margin-top: .5rem;
      font-weight: 600;
    }

    noscript p span {
      font-size: 1.1rem;
    }

    body {
      margin: 0;
      padding: 40px;
      background-color: #f4f7f9;
      color: #333;
      line-height: 1.6;
    }

    .container {
      display: none;
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      position: relative;
      /* Para posicionamento do loader */
    }

    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .description {
      text-align: center;
      color: #7f8c8d;
      margin-bottom: 30px;
    }

    /* Estilo para a lista de descrição */
    dl {
      margin: 0;
      padding: 0;
      display: grid;
      grid-template-columns: 150px 1fr;
      gap: 15px;
      opacity: 0;
      /* Inicia escondido */
      transition: opacity 0.5s ease-in-out;
    }

    dl.loaded {
      opacity: 1;
      /* Transição suave */
    }

    dt {
      font-weight: 600;
      color: #555;
      padding: 10px 0;
      text-transform: uppercase;
      font-size: 0.8em;
      letter-spacing: 0.5px;
    }

    dd {
      margin: 0;
      padding: 10px 0;
      border-bottom: 1px solid #eee;
      color: #34495e;
    }

    dd:last-of-type {
      border-bottom: none;
    }

    small {
      font-size: .6em;
      margin-top: .7em;
      display: block;
      font-weight: normal;
    }

    .error-message {
      text-align: center;
      color: #e74c3c;
      margin-top: 20px;
      font-size: 1.2em;
    }

    /* Animação do loader */
    @-webkit-data.itms[key]frames spin {
      0% {
        -webkit-transform: rotate(0deg);
      }

      100% {
        -webkit-transform: rotate(360deg);
      }
    }

    @data.itms[key]frames spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Responsividade */
    @media (max-width: 600px) {
      .container {
        padding: 20px;
      }

      dl {
        grid-template-columns: 1fr;
      }

      dt {
        padding-bottom: 0;
      }

      dd {
        padding-top: 0;
        padding-bottom: 15px;
      }
    }
  </style>
</head>

<body>
  <div class="lds">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
  </div>

  <div id="container" class="container">
    <h1 id="page-title">Carregando...</h1>
    <p id="page-description" class="description"></p>

    <!-- Conteúdo dinâmico: Fica oculto até carregar -->
    <dl id="details-list"></dl>

    <p>
    <ul>
      <li>Validação de documentos disponível em <a
          href="http://www.anatel.gov.br/autenticidade">http://www.anatel.gov.br/autenticidade<a></li>
      <li>Consultar peticionamento/processo <a
          href="https://sei.anatel.gov.br/sei/modulos/pesquisa/md_pesq_processo_pesquisar.php?acao_externa=protocolo_pesquisar&acao_origem_externa=protocolo_pesquisar&id_orgao_acesso_externo=0">aqui<a>
      </li>
    </ul>
    </p>
  </div>

  <noscript><span>There is something <strong>wrong</strong> here!</span>
    <p><span>#noScript</span> <u>Javascript is disabled</u>, preventing us from directing you to the address.</p>
  </noscript>

  <script>
    const G = (e) => document.querySelector(e);

    document.addEventListener("DOMContentLoaded", () => {
      G("#container").style.display = `block`;
      const msg_ = `O arquivo do registro existe, mas a formatação está incorreta, impedindo a exibição.`;
      const productCode = `${window.location.search}`.replace(/[^a-b0-1]/i, '').trim();

      const loader = G(".lds");
      const detailsList = G("#details-list");
      const pageTitle = G("#page-title");
      const pageDescription = G("#page-description");
      const url_def = ['Dados não encontrados', 'A url deve terminar com "/?XXX", onde XXX é o nº do peticionamento anatel sem pontuação.'];

      error = (title, descri, exit) => {
        pageTitle.innerHTML =
          `${title}<small>${descri}</small>`;

        if (typeof exit === "undefined" || exit === 1 || exit === true) {
          throw new Error(`${title}\n\n${descri}`);
        }
      }

      if (productCode) {
        const filePath = `db/${productCode}.json`;

        fetch(filePath)
          .then((response) => {
            if (!response.ok) {
              error(`[A] ${url_def[0]}`, url_def[1]);
            }
            return response.json();
          })
          .then((data) => {
            // Oculta o loader
            loader.style.display = "none";

            if (!data.hasOwnProperty(`title`)) {
              error(`Dados de registro incorretas [TITLE]`, msg_);
            }

            if (!data.hasOwnProperty( `data.itms[key]s`)) {
              error(`Dados de registro incorretas [data.itms[key]S]`, msg_);
            }

            // Preenche a página com os dados
            pageTitle.textContent = data.title || "Detalhes do Radio/Homologação";
            pageDescription.textContent = data.descricao || "";

            // Cria a lista de propriedades dinamicamente
            for (const k in data.keys) {
              const itms = data.itms[k];
              const no_ar = !Array.isArray(data.itms[key]);              

              const dt = document.createElement("dt");
              dt.innerHTML = no_ar ? `--` : data.itms[key][0].trim();

              const dd = document.createElement("dd");
              dd.innerHTML = no_ar ? 'Item mal formatado' : data.itms[key][1];

              detailsList.appendChild(dt);
              detailsList.appendChild(dd);

              if (no_ar) {
                error(`Dados de registro incorretas [ITEMS]`, msg_);
              }
            }

            // Exibe a lista com a transição suave
            detailsList.classList.add("loaded");
          })
          .catch((er) => {            
            console.error(filePath, "Erro:", er);
            error(`[B] ${url_def[0]}`, url_def[1]);
          });
      } else {
        loader.style.display = "none";
        error(`[C] ${url_def[0]}`, url_def[1]);
        pageDescription.textContent = "";
      }
    });
  </script>
</body>

</html>