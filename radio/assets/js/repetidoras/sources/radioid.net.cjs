function processarRegistro(o,s){const{state:a,country:r,status:e,locator:t,callsign:i,map_info:n,trustee:c,map:p,city:l,...d}=o;if(!/bra(s|z)il/i.test((r||"").trim())||"active"!==(e||"").toLowerCase())return null;const m=normalizarEstado(a);if(!m)return null;const g=processarNomeCidade(l,m);if(!g)return null;["frequency","offset","color_code","id"].forEach(o=>{null!=d[o]&&(d[o]=parseFloat(d[o])||0)}),d.info={},void 0!==d.frequency&&(d.rx=d.frequency,delete d.frequency),void 0!==d.color_code&&(d.color=d.color_code,delete d.color_code),void 0!==d.ts_linked&&(d.timeslot=converterTimeslot(d.ts_linked),delete d.ts_linked),void 0!==d.id&&(d.info.dmr_id=d.id,delete d.id),void 0!==d.ipsc_network&&(d.info.ipsc=capitalizar(d.ipsc_network),delete d.ipsc_network),void 0!==d.assigned&&(d.info.assigned=capitalizar(d.assigned),delete d.assigned),void 0!==d.rx&&void 0!==d.offset&&(d.tx=parseFloat((d.rx+d.offset).toFixed(5)));const f=`${m}:${g}`;s[f]=(s[f]||0)+1;const u=s[f];return d.name=u>1?`D/${m.toUpperCase()}/${g} [${u}]`:`D/${m.toUpperCase()}/${g}`,Object.keys(d).forEach(o=>{"string"==typeof d[o]&&"name"!==o&&(d[o]=capitalizar(d[o]))}),{estadoSigla:m,registro:d}}async function processarJSON(o,s,a,r=null,e=[PATH_FILE,__RPTDR_LNK],t="radioid.net"){try{const i=await s(e,t);if("object"!=typeof i||!Array.isArray(i?.rptrs))throw new Error("JSON inválido. Esperado objeto com '.rptrs'");const n={},c={},p={totalEstados:0,totalRegistros:0,registrosOriginais:i.rptrs.length,arquivosGerados:[],estadosProcessados:[],contents:{}};i.rptrs.forEach(o=>{const s=processarRegistro(o,c);if(s){const{estadoSigla:o,registro:a}=s;n[o]||(n[o]=[]),n[o].push(a)}}),cacheProcessado=n;for(const[s,r]of Object.entries(n)){r.sort((o,s)=>o.name.localeCompare(s.name));const e=o("",s),t=await a(r,e,s);p.contents[s]=r,p.totalEstados++,p.totalRegistros+=r.length,p.arquivosGerados.push(t),p.estadosProcessados.push(s),console.log(`Estado ${s.toUpperCase()}: ${r.length} registros`)}return console.log(`\nProcessado: ${p.totalEstados} estados, ${p.totalRegistros} registros (original: ${p.registrosOriginais})`),"function"==typeof r&&r(null,p),p}catch(o){throw console.error("Erro ao processar:",o),"function"==typeof r&&r(o,null),o}}const isNODE="undefined"==typeof window,fs=isNODE?require("fs"):null,path=isNODE?require("path"):null,commom=isNODE?require("../../../../../@assets/js/common.main.cjs"):"undefined"!=typeof window?window.commom:globalThis.commom,__RPTDR_LNK="https://radioid.net/static/rptrs.json",PATH_FILE="rptrs.json",estadosMap={acre:"ac",alagoas:"al",amapa:"ap","amapá":"ap",amazonas:"am",bahia:"ba",ceara:"ce","ceará":"ce","distrito federal":"df","espirito santo":"es","espírito santo":"es",goias:"go","goiás":"go",maranhao:"ma","maranhão":"ma","mato grosso":"mt","mato grosso do sul":"ms","minas gerais":"mg",para:"pa","pará":"pa",paraiba:"pb","paraíba":"pb",parana:"pr","paraná":"pr",pernambuco:"pe",piaui:"pi","piauí":"pi","rio de janeiro":"rj","rio grande do norte":"rn","rio grande do sul":"rs",rondonia:"ro","rondônia":"ro",roraima:"rr","santa catarina":"sc","sao paulo":"sp","são paulo":"sp",sergipe:"se",tocantins:"to",ac:"ac",al:"al",ap:"ap",am:"am",ba:"ba",ce:"ce",df:"df",es:"es",go:"go",ma:"ma",mt:"mt",ms:"ms",mg:"mg",pa:"pa",pb:"pb",pr:"pr",pe:"pe",pi:"pi",rj:"rj",rn:"rn",rs:"rs",ro:"ro",rr:"rr",sc:"sc",sp:"sp",se:"se",to:"to"};let cacheProcessado=null;const capitalizar=o=>"string"==typeof o?o.toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "):o,normalizarEstado=o=>o&&estadosMap[o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim()]||"",converterTimeslot=o=>o?o.replace(/TS/gi,"").trim().split(/\s+/).map(o=>parseInt(o,10)).filter(o=>!isNaN(o)&&o>0):[],processarNomeCidade=(o,s)=>{if(!o)return"";let a=String(o);const r=Object.keys(estadosMap).concat(["brazil","brasil"]);if(s){const o=Object.keys(estadosMap).find(o=>estadosMap[o]===s);if(o){o.split(" ").forEach(o=>{a=a.replace(new RegExp(`(^|\\s)[\\-,\\.\\/]?\\s*${o}\\s*($|[\\-,\\.\\/]|\\s)`,"gi"),"$1 ")})}}return r.forEach(o=>{a=a.replace(new RegExp(`(^|\\s)[\\-,\\.\\/]?\\s*${o}\\s*($|[\\-,\\.\\/]|\\s)`,"gi"),"$1 ")}),a=a.replace(/\s+/g," ").trim(),!a||a.length<2?capitalizar(o.replace(/\s+/g," ").trim()):capitalizar(a)};isNODE?module.exports={processarJSON:processarJSON}:window.processarJSON=processarJSON;