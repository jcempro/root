<!DOCTYPE html>
<html lang="pt-BR">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0"
		/>
		<meta name="robots" content="noindex" />
		<title>Carregando...</title>
		<style>
			:root {
				--blue: #c08282;
				--blue2: #2b92db;
				--amber: #cc4c1e;
				--gray: #777;
				--gray2: #eee;
				--border: #bbb;
				--text: #333;
				--bg: #f4f7f9;
				--radius: 1rem;
			}

			/* Base e tipografia */
			* {
				font-family: 'Noto Sans', Tahoma, Arial, sans-serif !important;
				line-height: 1.15em;
				margin: 0;
				padding: 0;
				color: var(--text);
			}

			body {
				padding: 2.5rem;
				background: var(--bg);
				line-height: 1.6;
			}

			a {
				color: var(--blue2);
				text-decoration: none;
			}
			a::after {
				content: '\279A';
				display: inline-block;
				margin: 0.15em;
				font-weight: 900;
				font-family: system-ui, 'Segoe UI', 'Apple Color Emoji',
					'Noto Color Emoji', sans-serif;
				color: var(--gray);
				border: 1px solid var(--border);
				background: var(--gray2);
				padding: 0.1em 0.1em 0.1em 0;
				border-radius: 0.25em;
				width: 0.6em;
				height: 0.6em;
				line-height: 0.6em;
				text-align: left;
			}

			/* Containers e layout */
			.container {
				display: none;
				max-width: 37.5rem;
				margin: auto;
				background: #fff;
				padding: 1.875rem;
				border-radius: 0.75rem;
				box-shadow: 0 0.25rem 1.25rem rgba(0, 0, 0, 0.08);
				position: relative;
			}

			.desc {
				text-align: justify;
				margin: 3em 0 1.875rem;
			}

			.dl {
				display: table;
				width: 100%;
				border-spacing: 0 0.3125rem;
				margin: 2em 0;
				text-align: left;
				opacity: 0;
				transition: opacity 0.5s ease-in-out;
			}
			.dl > .tbl {
				text-align: center;
			}
			.dl.loaded {
				opacity: 1;
			}
			.dl-row {
				display: table-row;
			}
			.dl-row:nth-child(odd) {
				background: var(--gray2);
			}
			.dt,
			.dd {
				display: table-cell;
				vertical-align: middle;
				padding: 0.3125rem 0;
			}
			.dt {
				font-weight: 600;
				text-transform: uppercase;
				font-size: 0.8rem;
				letter-spacing: 0.031rem;
			}
			.dd {
				padding-left: 0.625rem;
				border-bottom: 1px solid var(--gray2);
			}
			.dd:last-of-type {
				border: none;
			}
			.dt span,
			.dd span {
				padding-left: 0.5em;
			}

			/* Tipografia e blocos */
			h1 {
				text-align: center;
				color: var(--text);
				margin-bottom: 0.625rem;
				font-weight: 600;
				font-size: 1.7em;
				border-bottom: 1px solid #ddd;
				padding-bottom: 0.5rem;
			}

			p,
			ul,
			li {
				font-size: 1rem;
				font-weight: normal;
				text-align: justify;
				margin-top: 0.1rem;
			}

			p.sub,
			p.center {
				margin-bottom: 2rem;
				font-size: 1.3rem;
				text-align: center;
			}
			p.center a {
				display: inline-block;
				margin: 0.5em 1em;
			}
			p.center a::after {
				display: none;
			}

			span.url {
				background: var(--gray2);
				padding: 0 0.125rem;
			}

			sup {
				font-size: 0.7em;
				font-weight: bold;
				margin: 0 0.15em;
			}
			sup::before {
				content: '[';
				margin-right: 0.1em;
				font-weight: normal;
			}
			sup::after {
				content: ']';
				margin-left: 0.1em;
				font-weight: normal;
			}

			ul.main {
				padding-top: 0.7em;
				border-top: 1px solid #aaa;
			}
			ul {
				list-style: disc;
				padding-left: 1em;
			}
			li::marker {
				color: var(--gray);
				font-size: 1.1em;
			}
			li.nl {
				margin-top: 1.5em;
			}

			/* Tabelas */
			table {
				border-collapse: collapse;
				margin: 1rem 0;
				font-size: 0.9em;
				box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
				width: max-content;
				display: inline-block;
			}
			th,
			td {
				padding: 0.7em 0.5em;
				border: 1px solid var(--border);
				cursor: pointer;
				text-align: left;
				white-space: nowrap;
			}
			tr:first-child * {
				background: var(--gray);
				color: #fff;
				font-weight: bold;
			}
			tr:nth-child(even) {
				background: #e0e0e0;
			}
			tr:nth-child(odd) {
				background: #fff;
			}
			tr:hover {
				background: var(--blue2);
				color: #fff;
			}
			tbody tr:last-of-type {
				border-bottom: 2px solid #009879;
			}

			/* Mensagens */
			.error-message {
				text-align: center;
				color: #e74c3c;
				margin-top: 1.25rem;
				font-size: 1.2rem;
			}

			/* noscript */
			noscript {
				text-align: center;
			}
			noscript main {
				background: #fff;
				border: 0.1rem solid var(--blue);
				border-radius: var(--radius);
				box-shadow: 0 0 1rem rgba(0, 0, 0, 0.1);
				width: min(90vw, 28rem);
				max-width: 90vw;
				padding: 1.5rem;
				box-sizing: border-box;
				overflow-wrap: break-word;
				display: inline-block;
			}
			noscript h1 {
				background: #845050;
				color: #fff;
				font-size: 1.5rem;
				font-weight: 700;
				display: flex;
				align-items: center;
				gap: 0.5rem;
				border-radius: var(--radius) var(--radius) 0 0;
				padding: 0.5em 1em;
				margin: calc(-1rem - 1px) calc(-1rem - 2px) 0.3rem;
			}
			noscript h1 span {
				font-size: 1.8rem;
				margin: 0.2rem;
			}
			noscript p {
				margin: 0.2rem 0;
				line-height: 1.4;
				text-align: left;
			}
			noscript .lang {
				border-top: 1px solid rgba(0, 0, 0, 0.1);
				margin-top: 1rem;
				padding-top: 0.5rem;
				font-size: 0.9rem;
			}
			noscript .lang:first-of-type {
				border: none;
			}
			noscript .lang h2 {
				color: var(--blue);
				margin-bottom: 0.2rem;
				font-size: 0.9rem;
			}
			noscript strong {
				color: var(--amber);
				font-style: italic;
				margin-left: 0.4em;
			}

			/* Loader */
			.lds {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 0.7rem;
				border-bottom: 1px solid var(--gray2);
				background: linear-gradient(
					90deg,
					var(--blue2) 0%,
					var(--blue2) 50%,
					transparent 100%
				);
				background-size: 200% 100%;
				animation: loading 2s linear infinite;
				z-index: 9999;
			}

			@keyframes loading {
				0% {
					background-position: 200% 0;
				}
				100% {
					background-position: -200% 0;
				}
			}

			/* Responsividade */
			@media (max-width: 37.5rem) {
				body {
					padding: 0;
				}
				.container {
					padding: 2rem 1rem;
				}
				.dt,
				.dd {
					display: block;
					padding-left: 0;
				}
				.dt {
					margin-bottom: 0.1875rem;
				}
				.dd {
					padding-bottom: 0.625rem;
					border-bottom: 1px solid var(--gray2);
				}
			}
			@media (max-width: 600px) {
				noscript main {
					max-width: 85vw;
					padding: 1rem;
				}
				noscript h1 {
					font-size: 1.3rem;
				}
			}
		</style>
	</head>
	<body>
		<div class="lds"></div>

		<div class="container">
			<h1 id="ttl"></h1>
			<p class="desc"></p>
			<div class="dl"></div>
			<ul class="main">
				<li>
					A valida√ß√£o de documentos Anatel est√° dispon√≠vel em
					<a
						target="_blank"
						href="http://www.anatel.gov.br/autenticidade"
						>anatel.gov.br</a
					>
				</li>
				<li>
					Consultar peticionamento/processo
					<a
						target="_blank"
						href="https://sei.anatel.gov.br/sei/modulos/pesquisa/md_pesq_processo_pesquisar.php?acao_externa=protocolo_pesquisar&acao_origem_externa=protocolo_pesquisar&id_orgao_acesso_externo=0"
						>anatel.gov.br</a
					>
				</li>
				<li>
					Dicas, tabelas, modelos, constru√ß√µes, antenas, limites entre
					outros em
					<a target="_blank" href="https://jeancarloem.com/radio"
						>jeancarloem.com/radio</a
					>
				</li>
				<li><a href="/radio/?sumario0">Sum√°rio</a> de r√°dios.</li>
				<li class="nl">
					<sup>0</sup><strong>Homologa√ß√£o</strong> refere-se a pr√≥pria
					homologa√ß√£o ou outro documentooficial an√°logo,como uma
					decis√£o ou despacho.
				</li>
			</ul>
		</div>
		<noscript>
			<main>
				<h1><span>‚ö†Ô∏è</span>Problem / Problema / ÈóÆÈ¢ò</h1>
				<div class="lang">
					<h2>üá∫üá∏ English</h2>
					<p>
						<span>‚ö†Ô∏è</span><strong>JavaScript is disabled.</strong
						><br />
						This prevents automatic redirection to your destination.
					</p>
				</div>
				<div class="lang">
					<h2>üáßüá∑ Portugu√™s</h2>
					<p>
						<span>‚ö†Ô∏è</span
						><strong>O JavaScript est√° desativado.</strong><br />
						Isso impede o redirecionamento autom√°tico para o destino.
					</p>
				</div>
				<div class="lang">
					<h2>üá™üá∏ Espa√±ol</h2>
					<p>
						<span>‚ö†Ô∏è</span
						><strong>JavaScript est√° deshabilitado.</strong><br />
						Esto impide la redirecci√≥n autom√°tica al destino.
					</p>
				</div>
				<div class="lang">
					<h2>üá®üá≥ ‰∏≠ÊñáÔºàÊôÆÈÄöËØùÔºâ</h2>
					<p>
						<span>‚ö†Ô∏è</span><strong>JavaScript Â∑≤Ë¢´Á¶ÅÁî®„ÄÇ</strong
						><br />
						Ëøô‰ºöÈòªÊ≠¢Ëá™Âä®Ë∑≥ËΩ¨Âà∞ÁõÆÊ†áÈ°µÈù¢„ÄÇ
					</p>
				</div>
			</main>
		</noscript>
		<script>
			const _ = (e) => document.querySelector(e);
			document.addEventListener('DOMContentLoaded', () => {
				const CODIGO = `${window.location.search}`
					.split('radio/')
					.pop()
					.split(`?`)
					.pop()
					.replace(/[^a-z0-9\/]/i, '')
					.trim()
					.split(`/`);

				const SUMARIO = `\n\n<br /><br /><p>Consulte o <a href="/radio/?sumario0">Sum√°rio</a> para lista de r√°dios.</p>`;
				const CID = CODIGO[0].trim();
				const LOAD = _('.lds');
				const LST = _('.dl');

				const MSG1 = (id) => [
					id,
					`Dados de registro incorretas`,
					`O arquivo do registro existe, mas a formata√ß√£o est√° incorreta, impedindo a exibi√ß√£o.`,
				];

				const MSG2 = (id, tt = 0) => [
					id,
					`Par√¢metro inexistente${tt ? ' ou inv√°lido' : ''}`,
					`A url deve terminar com <span class="url">"/?<b>XXX</b>"</span>, onde "XXX" √© o n¬∫ do peticionamento, despacho ou homologa√ß√£o Anatel sem pontua√ß√£o. ${SUMARIO}`,
				];

				const MSG3 = (id) => [
					id,
					`Sum√°rio mal formatado`,
					`O sum√°rio existente, mas possui uma formata√ß√£o incompat√≠vel para exibi√ß√£o`,
				];

				const CST = (x) =>
					x.charAt(0).toUpperCase() + x.slice(1).toLowerCase() || '';

				const TAG = (o, x = 0) => {
					if (x) o.innerHTML = x;
					return o.innerHTML.trim();
				};

				const DESC = _('.desc');
				const PURE_TXT = (s) => s.replace(/(<([^>]+)>)/gi, '');

				const TITULO = (t) => {
					TAG(_('#ttl'), t);
					document.title = PURE_TXT(t);
				};

				const LOADED = () => {
					_('.container').style.display = 'block';
					window.setTimeout(() => {
						LST.classList.add('loaded');
						LOAD.style.display = 'none';
					}, 50);
				};

				const EnclouseTag = (v, tag = `span`) =>
					/^\s*<[\w]+/i.test(v) ? v : `<${tag}>${v}</${tag}>`;

				const ERR = (id, title, descri, exit) => {
					const txt = `\n\n${descri}`;
					const m = `‚ö†Ô∏è ${title}${ERR_ID(id)}`;
					if (TAG(_('#ttl')) === ``) {
						TITULO(m);
						LOADED();
					}

					TAG(DESC, txt);

					if (
						typeof exit === 'undefined' ||
						exit === 1 ||
						exit === true
					)
						throw new Error(PURE_TXT(`${title}${txt}`));
				};

				const ERR_ID = (id) =>
					id ? `<sup>${`${id}`.toUpperCase()}</sup>` : '';

				const IS_STRING = (x) => typeof x === `string`;
				const KEYSofOBJ = (x) => Object.keys(x);
				const HAS_KEY = (o, y) => Object.hasOwn(o, y);
				const IS_ARR = (x) => Array.isArray(x);

				const CREATE_EL = (t, x, c = ``, ct = ``) => {
					const r = document.createElement(x);
					r.className = c;
					TAG(r, ct);
					if (t) t.appendChild(r);
					return r;
				};

				if (/([^a-z0-9])/i.test(CID)) return ERR(...MSG2('1T'));

				const CED =
					CODIGO.length >= 2
						? `${CODIGO[1]}`.trim().toLowerCase()
						: 0;

				const isL = (v) => /^\s?(http|ftp)s?:\/\//.test(v);

				const MAKE_LINK = (y, ol = 0) => {
					if (ol && IS_STRING(y) && isL(y)) return y.trim();
					if (!IS_ARR(y)) return ol ? 0 : y;
					if (y.length === 0) return ``;
					if (IS_STRING(y[0])) {
						const pl = isL(y[0]) ? 0 : isL(y[1]) ? 1 : -1;
						const l = `${y[pl]}`.trim();
						if (ol) return l;
						const t = y[pl === 0 ? 1 : 0];
						return `<a href="${l}" target="_blank">${t}</a>`;
					}
					if (!IS_ARR(y[0])) return '';
					return ol
						? y.map((z) => MAKE_LINK(z, ol))
						: '<ul>' +
								y
									.map((z) => MAKE_LINK(z, 0))
									.map((n) => `<li>${n}</li>`)
									.join('') +
								'</ul>';
				};

				const PROPS1 = {
					id: 'Peticionamento/Processo',
					tp: 'Tipo de processo',
					dp: 'Data da Peti√ß√£o',
					mc: 'Marca',
					md: 'Modelo',
					fccid: 'FCC ID',
					sn: 'N√∫mero de S√©rie',
					r: 'Homologa√ß√£o<sup>1</sup>',
					v: 'Valida√ß√£o da Homologa√ß√£o<sup>1</sup>',
					dt: 'Data de Homologa√ß√£o',
				};

				const PROPS2 = {};
				const PROPS = { ...PROPS1, ...PROPS2 };
				const PROPS_MSG =
					"\n\n<p>Apenas os destinos abaixos podem ser usados, <b>mas</b> note que a maioria n√£o conter√£o URL:</p><ul class='pr'>" +
					Object.entries(PROPS)
						.map(
							([chave, valor]) =>
								`<li><b>${chave}:</b> ${valor}</li>`,
						)
						.join('') +
					`</ul>${SUMARIO}`;
				const _S = {
					imp: 'Certifica√ß√£o de Produto: Declara√ß√£o de Conformidade - Importado uso Pr√≥prio',
				};

				const HOMOLOGACA_TEXT = (x) => {
					if (IS_STRING(x) && x.trim().length > 0) return x;
					if (IS_ARR(x) && x.length === 2) {
						return `C√≥digo: ${x[0]}<br />CRC: ${x[1]}`;
					}
					return '';
				};

				const RP = (str) => {
					return `${str}`.replace(/\$\{([\w\d]+)\}/g, (_, k) => {
						const i = k.trim().toLowerCase();
						const val = _S == null || !HAS_KEY(_S, i) ? null : _S[i];
						return val === null ? `???` : `${val}`;
					});
				};

				const PRE_FORMAT = (x, k = undefinewd) => {
					return RP(k === 'v' ? HOMOLOGACA_TEXT(x) : MAKE_LINK(x));
				};

				const ADD = (k, v) => {
					const row = CREATE_EL(0, 'div', 'dl-row');
					CREATE_EL(
						row,
						'div',
						'dt',
						k === null ? `--` : EnclouseTag(k),
					);
					CREATE_EL(
						row,
						'div',
						`dd`,
						k === null
							? 'Item mal formatado'
							: v && v.trim().length > 0
							? EnclouseTag(v)
							: `---`,
					);
					LST.appendChild(row);
				};

				const SUM_COLS = ['Peticionamento', 'Marca', 'Modelo'];

				const LST_H = (d) => {
					if (!Array.isArray(d)) {
						return ERR(...MSG3('S1'));
					}

					const dst = _('.dl table')
						? _('.dl table')
						: (() => {
								_('.dl').insertAdjacentHTML(
									'beforeend',
									'<div class="tbl"><table cellsspacing="0" border="0" cellpadding="0"></table></div>',
								);
								return _('.dl table');
						  })();

					const add_row = (o, t = 0) => {
						const row = CREATE_EL(0, 'tr', '');
						for (const k in o) {
							const v = o[k];
							CREATE_EL(
								row,
								'td',
								'',
								EnclouseTag(
									`${v}${k == 0 && !t ? EnclouseTag('üîó') : ''}`,
								),
							);
						}

						row.addEventListener('click', (e) => {
							try {
								window.location =
									'../radio/?' + o[0].replace(/[^a-z0-9]/i, ``);
							} catch (error) {}
						});

						dst.appendChild(row);
					};

					add_row(SUM_COLS, 1);

					for (k = 0; k < d.length; k++) {
						const e = d[k];

						if (k === d.length - 1 && isFinite(e) && !isNaN(e)) {
							_('.dl').insertAdjacentHTML(
								'beforeend',
								`<p class="center">
									${e >= 2 ? `<a href="?sumario${e - 2}">¬´ Anterior</a>` : ''}
								${e < 0 ? '' : `<a href="?sumario${e}">Pr√≥ximo ¬ª</a>`}
								</p>`,
							);
						} else if (
							!Array.isArray(e) ||
							e.length !== SUM_COLS.length
						) {
							return ERR(...MSG3('S2'));
						}

						add_row(e);
					}

					TITULO('Sum√°rio');
					LOADED();
				};

				if (CODIGO) {
					const fURL =
						`db/${CID}.json?t=` +
						Math.random().toString(36).substring(2, 18);

					fetch(fURL)
						.then((response) => {
							if (!response.ok) return ERR(...MSG2(`AX`, 1));
							return response.json();
						})
						.then((data) => {
							if (/sumario[\d]+/i.test(CID.toLowerCase())) {
								return LST_H(data);
							}
							for (const i of KEYSofOBJ(PROPS1))
								if (!HAS_KEY(data, i)) return ERR(...MSG1(`:${i}`));

							if (!HAS_KEY(data, 'items') || !IS_ARR(data.items))
								return ERR(...MSG1('ITM1'));
							if (CODIGO.length >= 2) {
								if (!HAS_KEY(PROPS, CED)) {
									return ERR(
										`D1`,
										`Destino "${CED}" inv√°lido`,
										`Destino n√£o √© permitido.${PROPS_MSG}`,
										1,
									);
								}
								if (!HAS_KEY(data, CED)) {
									return ERR(
										`D2`,
										`Destino "${CED}" inexistente`,
										`Vari√°vel n√£o definida no registro.${PROPS_MSG}`,
										1,
									);
								}
								const idx =
									CODIGO.length > 2 ? parseInt(`${CODIGO[2]}`) : 0;
								const rr = MAKE_LINK(
									!isNaN(idx) &&
										idx < data[CED].length &&
										IS_ARR(data[CED][idx])
										? data[CED][idx]
										: data[CED],
									1,
								);
								return rr
									? (() => {
											TITULO('Redirecionando...');
											window.location = rr;
									  })()
									: ERR(
											`D3`,
											`Destino "${CED}" inv√°lido`,
											`Vari√°vel de destino n√°o √© uma URL v√°lida ou existente.${PROPS_MSG}`,
											1,
									  );
							} else {
								TITULO(`<small>${CST(data.mc)}</small> ${data.md}`);

								for (const j of [
									...KEYSofOBJ(PROPS),
									...data.items,
									[
										'Solicitante',
										atob(
											'PHN0cm9uZz5QVTJZUUM8L3N0cm9uZz4gKEplYW4gQ2FybG8pPGJyIC8+PGk+amVhbmNhcmxvQGplYW5jYXJsb2VtLmNvbTwvaT48YnIgLz5DUEY6IDMzKi4qKiouKio4LTk1',
										),
									],
								]) {
									const val = IS_ARR(j)
										? j
										: [PROPS[j] || null, data[j]];
									ADD(RP(val[0]), PRE_FORMAT(val[1], j));
									if (!val[0]) return ERR(MSG1(`ITM2`));
								}
								LOADED();
							}
						})
						.catch((er) => {
							console.error(fURL, '\n', er);
							ERR(...MSG2('BX'));
						});
				} else {
					ERR(...MSG2('CX'));
				}
			});
		</script>
	</body>
</html>
